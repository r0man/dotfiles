;; -*- lisp -*-
(require :stumpwm)
(require :swank)

(in-package :stumpwm)

;; Mode Line
(stumpwm:set-fg-color "white")
(stumpwm:set-bg-color "black")
(stumpwm:set-border-color "black")

(setf *mode-line-background-color* "black")
(setf *mode-line-foreground-color* "Gray50")
(setf *mode-line-border-color* "black")

;; Input focus follows the mouse.
(setf *mouse-focus-policy* :sloppy)

(defun start-swank-server ()
  (swank-loader:init)
  (swank:create-server
   :port 4005
   :style swank:*communication-style*
   :dont-close t))

(defcommand terminal () ()
  "Run or raise the urxvt terminal."
  (run-or-raise "urxvt -e screen" '(:class "URxvt")))

(defcommand file-manager () ()
  "Run or raise the file manager."
  (run-or-raise "nautilus" '(:class "Nautilus")))

(defcommand volume-lower () ()
  "Lower the volume."
  (message "Lower volume"))

(defcommand volume-raise () ()
  "Raise the volume."
  (message "Raise volume"))

(defcommand volume-toggle () ()
  "Toggle the volume."
  (message "Toggle volume"))

(define-key *root-map* (kbd "c") "terminal")

;; Volume keys
(define-keysym #x1008ff11 "XF86AudioLowerVolume")
(define-keysym #x1008ff12 "XF86AudioMute")
(define-keysym #x1008ff13 "XF86AudioRaiseVolume")
(define-key *top-map* (kbd "XF86AudioLowerVolume") "volume-lower")
(define-key *top-map* (kbd "XF86AudioRaiseVolume") "volume-raise")
(define-key *top-map* (kbd "XF86AudioMute") "volume-toggle")

;; Enable the mode line
(mode-line)

;; Change prefix key
(set-prefix-key (kbd "C-z"))

(start-swank-server)
